---
import CommonLayout from '../../layout/CommonLayout.astro';
import PageTitle from '../../components/PageTitle.astro';
import PageLayout from '../../layout/PageLayout.astro';

import { Content } from './_internal/page/Content';

import { collectionToWork } from '../../context/work/services';
import { getCollection } from 'astro:content';
import { processImageForWorkCard } from '../../features/work/services/image';
import type { WorkCardProps } from '../../features/work/components/WorkCard';

const worksCollectionEntries = await getCollection('works');
const works = worksCollectionEntries.map((work) => collectionToWork(work));

const workCardProps: WorkCardProps[] = await Promise.all(works.map((work) => processImageForWorkCard(work)));
---

<CommonLayout>
	<PageTitle title="works" />
	<PageLayout>
		<Content client:load {workCardProps} />
	</PageLayout>
</CommonLayout>
